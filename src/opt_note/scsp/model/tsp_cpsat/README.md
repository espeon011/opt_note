# 順序制約付き巡回セールスマン問題として定式化 (CP-SAT)

## 概要

- 計算量: ?
- 近似精度: $n$

各文字列の各文字を頂点とした TSP に頂点を訪れる順序を定める制約を課して定式化する. 

### 決定変数

- $x_{(i_1, j_1),(i_2, j_2)} \in \lbrace 0, 1 \rbrace$: $i_1$ 番目の文字列の $j_1$ 番目の文字に対応する頂点と $i_2$ 番目の文字列の $j_2$ 番目の文字に対応する頂点を結ぶ辺を使用するかどうかを表す 0-1 変数. 
- $y_{(i, j)} \in \mathbb{Z}$: $i$ 番目の文字列の $j$ 番目の文字は巡回において何番目に訪れるか. 

### 制約条件

- ダミーの頂点を入れたうえで circuit 制約を課す. 
- ダミーの頂点を訪れる順番を $0$ に固定し, $y_{(i, j)}$ たちに「$x_{(i_1, j_1),(i_2, j_2)} = 1$ ならば $y_{(i_2, j_2)} = y_{(i_1, j_1)} + 1$」を課す. 
- $y_{(i, j)} < y_{(i, j+1)} \ (\forall i = 1, \dots, n, \ \forall j = 1, \dots, |s_i| - 1)$

### 目的関数

頂点間の遷移コストは次のように定義する. 

- 同じ文字列に対応する頂点間の遷移は次のように定義する:
  頂点 $(i, j_1)$ から頂点 $(i, j_2)$ へは $j_2 = j_1 + 1$ のときに限りコスト $1$ で遷移できる. 
  そうでないときは遷移できない. 
- 異なる文字列に対応する頂点間の遷移は次のように定義する:
  $i_1 \neq i_2$ として頂点 $(i_1, j_1)$ から頂点 $(i_2, j_2)$ へは $i_1 < i_2$ かつ対応する文字が等しい時のみコスト $0$ で遷移できる. 
  そうでないときはコスト $1$ で遷移できる. 
- ダミーノードから各頂点へはコスト $1$ で遷移でき, 各頂点からダミーノードへはコスト $0$ で遷移できる. 

上記のコストのもと, 巡回路を形成する全ての辺のコストの和を最小化する. 
